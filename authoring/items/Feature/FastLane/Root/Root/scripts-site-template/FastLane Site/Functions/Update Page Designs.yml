---
ID: "956c4a38-c3aa-4271-8b9a-91d75fdabe1e"
Parent: "521085ce-4ba5-414f-b885-df138ae15174"
Template: "dd22f1b3-bd87-4db2-9e7d-f7a496888d43"
Path: /sitecore/system/Modules/PowerShell/Script Library/JSS SXA/FastLane Site/Functions/Update Page Designs
SharedFields:
- ID: "b1a94ff0-6897-47c0-9c51-aa6acb80b1f0"
  Hint: Script
  Value: |
    Import-Function Get-ItemByIdSafe
    Import-Function Get-ProjectTemplateBasedOnBaseTemplate
    Import-Function Add-SiteModule
    Import-Function Invoke-AddItem
    Import-Function Get-Action
    
    function Invoke-ModuleScriptBody {
        [CmdletBinding()]
        param(
            [Parameter(Mandatory = $true, Position = 0)]
            [Item]$Site,
    
            [Parameter(Mandatory = $true, Position = 1)]
            [Item[]]$TenantTemplates
        )
    
        begin {
            Write-Log "Cmdlet Invoke-ModuleScriptBody - Begin"
        }
    
        process {
            if ($null -eq $Site) {
                Write-Log "[Site creation] Site parameter is null. Cannot proceed."
                return
            }
            
            Write-Log "Cmdlet Invoke-ModuleScriptBody - Process"
            $sitePath = $Site.Paths.Path
            Write-Log "My site: $sitePath"
    		
    		$SharedSiteItemId = "{C197DBD2-75C1-4993-932B-ADB65397C867}"
    		$SharedSiteItem = Get-Item -Path "master:" -ID $SharedSiteItemId
    		$SharedSitePath = $SharedSiteItem.ItemPath
    		Write-Log "My Shared site: $SharedSitePath"
    
            Write-Log "[FASTLANE SITE CREATION] Update partial design field for copied page design. Replacing header and footer with local partial designs."
    		
            Write-Log "[FASTLANE SITE CREATION] Copying Partial to local site: MainNavigationHeader"
            $sharedMainNavigationHeaderPartial = Get-Item -Path "$SharedSitePath/Presentation/Partial Designs/MainNavigationHeader"
    		Copy-Item -Path $sharedMainNavigationHeaderPartial.ItemPath -Destination "$sitePath/Presentation/Partial Designs"
            $mainNavigationHeaderPartial = Get-Item -Path "$sitePath/Presentation/Partial Designs/MainNavigationHeader"
    		
            Write-Log "[FASTLANE SITE CREATION] Copying Partial to local site: Footer"
            $sharedFooterPartial = Get-Item -Path "$SharedSitePath/Presentation/Partial Designs/Footer"
    		Copy-Item -Path $sharedFooterPartial.ItemPath -Destination "$sitePath/Presentation/Partial Designs"
            $footerPartial = Get-Item -Path "$sitePath/Presentation/Partial Designs/Footer"
    		
            Get-ChildItem -Path "$sitePath/Presentation/Page Designs" | ForEach-Object {
                $pageDesignItem = $_
    			Write-Log "[FASTLANE SITE CREATION] UPDATING partial designs on page design: $($pageDesignItem.ItemPath)"
                $partialDesignIDs = $pageDesignItem["PartialDesigns"]
                $pageDesignItem.Editing.BeginEdit()
                if ($partialDesignIDs.Contains($sharedMainNavigationHeaderPartial.ID)) {      
                    $partialDesignIDs = $partialDesignIDs.Replace($sharedMainNavigationHeaderPartial.ID, $mainNavigationHeaderPartial.ID)
                }
                if ($partialDesignIDs.Contains($sharedFooterPartial.ID)) {
                    $partialDesignIDs = $partialDesignIDs.Replace($sharedFooterPartial.ID, $footerPartial.ID)
                }            
                $pageDesignItem["PartialDesigns"] = $partialDesignIDs
                $pageDesignItem.Editing.EndEdit()
    			Write-Log "[FASTLANE SITE CREATION] UPDATED partial designs on page design: $($pageDesignItem.ItemPath) - $($partialDesignIDs)"
            }
    
            Write-Log "[FASTLANE SITE CREATION] Update Page Design item for template and Page Design mapping"        
            #update Page Design item for template and Page Design mapping - start.
    		$articlePageTemplateId = "{6429BD7B-C674-4249-A95B-E382A2672901}"
    		$blankPageTemplateId = "{F58DC353-B0B5-4015-9659-1BCD318BF36E}"
    		$contentPageWithSidebarTemplateId = "{58C7B74F-D255-4002-9B02-CE1B0D25624A}"
    		$landingPageTemplateId = "{42DF736E-FF50-4722-A116-F11E157383D7}"
    		$landingPageWithSidebarTemplateId = "{770FD597-EA0B-4FF3-944F-9248AEDFE84A}"
    		$listingPageTemplateId = "{A07BDB02-B3F4-4B2D-997D-48FDDCA9192E}"
    		$404PageTemplateId = "{A72B63D3-B413-46AF-A7BC-B51189AA0D48}"
    		$500PageTemplateId = "{45DD95DC-B920-457E-9894-A407AF1E3F4F}"
    		
            $contentPagewithSidebarPageDesign = Get-Item -Path "$sitePath/Presentation/Page Designs/ContentPagewithSidebar"
            $defaultPageDesign = Get-Item -Path "$sitePath/Presentation/Page Designs/Default"
            $headerAndFooterPageDesign = Get-Item -Path "$sitePath/Presentation/Page Designs/HeaderAndFooter"
            $landingPageWithSidebarLayoutRoutingPageDesign = Get-Item -Path "$sitePath/Presentation/Page Designs/Landing Page with Sidebar LayoutRouting"
            $landingPagePageDesign = Get-Item -Path "$sitePath/Presentation/Page Designs/Landing Page"
            $landingPageWithSidebarPageDesign = Get-Item -Path "$sitePath/Presentation/Page Designs/Landing Page with Sidebar"
            $listingPagePageDesign = Get-Item -Path "$sitePath/Presentation/Page Designs/ListingPage"
            $articlePagePageDesign = Get-Item -Path "$sitePath/Presentation/Page Designs/ArticlePage"
            $pageDesignsItem = Get-Item -Path "$sitePath/Presentation/Page Designs"
    		
            $mappingPlain = @(
                "$blankPageTemplateId=$($defaultPageDesign.ID)",
                "$landingPageTemplateId=$($landingPagePageDesign.ID)",
                "$landingPageWithSidebarTemplateId=$($landingPageWithSidebarPageDesign.ID)",
                "$listingPageTemplateId=$($listingPagePageDesign.ID)",
                "$articlePageTemplateId=$($articlePagePageDesign.ID)",
                "$contentPageWithSidebarTemplateId=$($contentPagewithSidebarPageDesign.ID)",
                "$404PageTemplateId=$($defaultPageDesign.ID)",
                "$500PageTemplateId=$($defaultPageDesign.ID)"
            ) -join "&"
    		
            $mappingEncoded = [System.Web.HttpUtility]::UrlEncode($mappingPlain)
            $pageDesignsItem.Editing.BeginEdit()
            $pageDesignsItem["TemplatesMapping"] = $mappingEncoded
            $pageDesignsItem.Editing.EndEdit()
    
     
        }
    
        end {
            Write-Log "Cmdlet Invoke-ModuleScriptBody - End"
        }
    } 
- ID: "dbbbeca1-21c7-4906-9dd2-493c1efa59a2"
  Hint: __Shared revision
  Value: "c9cfbb83-84a5-4309-830a-99e58ef033bb"
Languages:
- Language: en
  Versions:
  - Version: 1
    Fields:
    - ID: "25bed78c-4957-4165-998a-ca1b52f67497"
      Hint: __Created
      Value: 20250628T191600Z
    - ID: "52807595-0f8f-4b20-8d2a-cb71d28c6103"
      Hint: __Owner
      Value: |
        sitecore\andy.cohen@altudo.co
    - ID: "5dd74568-4d4b-44c1-b513-0af5f4cda34f"
      Hint: __Created by
      Value: |
        sitecore\andy.cohen@altudo.co
    - ID: "8cdc337e-a112-42fb-bbb4-4143751e123f"
      Hint: __Revision
      Value: "c452878a-c094-4429-8373-3751227e89f7"
    - ID: "badd9cf9-53e0-4d0c-bcc0-2d784c282f6a"
      Hint: __Updated by
      Value: |
        sitecore\andy.cohen@altudo.co
    - ID: "d9cf14b1-fa16-4ba6-9288-e8a174d4d522"
      Hint: __Updated
      Value: 20250701T084210Z
